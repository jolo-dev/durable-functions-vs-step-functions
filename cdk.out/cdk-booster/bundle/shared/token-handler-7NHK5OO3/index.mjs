import{SFNClient as d,SendTaskSuccessCommand as r}from"@aws-sdk/client-sfn";var i=new d({}),a=new DynamoDBClient({}),m=async e=>{let n=typeof e.body=="string"?JSON.parse(e.body):e.body,{token:t,code:o}=n;if(!t||!o)return{statusCode:400,body:JSON.stringify({error:"token and code required"})};if((await a.send(new GetItemCommand({TableName:process.env.TABLE_NAME,Key:{id:{S:t}}}))).Item?.code?.S!==o)return{statusCode:400,body:JSON.stringify({error:"Invalid verification code"})};let s=new r({taskToken:t,output:JSON.stringify({verification:"ok"})});return await i.send(s),{statusCode:200,body:JSON.stringify({message:"Verification accepted"})}};export{m as handler};
